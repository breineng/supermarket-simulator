# План разработки симулятора супермаркета

## Этап 1: Базовая архитектура и настройка (Выполнено)

-   [x] Настройка BInject: создание/обновление `BInjectSettings.asset` с контекстами "Application", "Menu", "Game".
-   [x] Создание скриптов-инициализаторов для контекстов:
    -   [x] `Assets/Scripts/Contexts/ApplicationContextInitiator.cs`
    -   [x] `Assets/Scripts/Contexts/MenuContextInitiator.cs`
    -   [x] `Assets/Scripts/Contexts/GameContextInitiator.cs`
-   [x] Создание базовых сцен:
    -   [x] `Assets/Scenes/InitScene.unity` (с ApplicationContextHolder)
    -   [x] `Assets/Scenes/MenuScene.unity` (с MenuContextHolder)
    -   [x] `Assets/Scenes/GameScene.unity` (с GameContextHolder)
-   [x] **(Требуется ручное действие)** Добавить сцены `InitScene`, `MenuScene`, `GameScene` в Build Settings (`InitScene` - первая).

## Этап 2: Application Context - Основные сервисы (Выполнено)

-   [x] **Сервис управления сценами (SceneManagementService):**
    -   [x] Определить интерфейс `ISceneManagementService`.
    -   [x] Реализовать `SceneManagementService` (загрузка сцен, асинхронная загрузка).
    -   [x] Зарегистрировать в `ApplicationContext`.
-   [x] **Сервис конфигурации игры (GameConfigService):**
    -   [x] Определить структуру для хранения настроек игры (например, через ScriptableObjects).
    -   [x] Реализовать сервис для доступа к этим конфигурациям.
    -   [x] Зарегистрировать в `ApplicationContext`.
-   [x] **Сервис пользовательских данных/прогресса (PlayerDataService):**
    -   [x] Определить структуру данных игрока.
    -   [x] Реализовать сервис для сохранения/загрузки данных (пока можно использовать PlayerPrefs или заглушку).
    -   [x] Зарегистрировать в `ApplicationContext`.
-   [x] **Базовый загрузчик (`AppStartup`):**
    -   [x] Создать скрипт `AppStartup.cs` на сцене `InitScene`.
    -   [x] Внедрить `ISceneManagementService`.
    -   [x] После инициализации `ApplicationContext`, автоматически загружать `MenuScene`.

## Этап 3: Menu Context - Главное меню (Выполнено)

-   [x] **Система UI для меню (с использованием UI Toolkit):**
    -   [x] Созданы папки `Assets/UI/MainMenu/`.
    -   [x] Создан UXML документ `Assets/UI/MainMenu/MainMenu.uxml` (с кнопками NewGameButton, ExitButton).
    -   [x] Создан пустой USS файл `Assets/UI/MainMenu/MainMenu.uss`.
    -   [x] GameObject "MenuContextHolder" в `MenuScene` настроен с компонентом `UIDocument`.
    -   [x] **(Требуется ручное действие)** Назначить `Assets/UI/MainMenu/MainMenu.uxml` в поле "Visual Tree Asset" компонента `UIDocument` на "MenuContextHolder".
    -   [x] Создана папка `Assets/Scripts/Services/Menu/`.
    -   [x] Создан скрипт `Assets/Scripts/Services/Menu/MenuUIHandler.cs`.
    -   [x] `MenuUIHandler.cs` добавлен на "MenuContextHolder" вместе с `BehaviourInject.Injector`.
    -   [x] Реализована логика для кнопок в `MenuUIHandler.cs`:
        -   "Новая игра": Сброс данных игрока (`IPlayerDataService.ResetData()`), переход на `GameScene` (`ISceneManagementService.LoadScene("GameScene")`).
        -   "Выход": `Application.Quit()` (с учетом `#if UNITY_EDITOR`).
    -   [x] Зарегистрировать необходимые сервисы/презентеры в `MenuContext` (пока не требуется, так как `MenuUIHandler` получает зависимости из `ApplicationContext` через `Injector` на сцене).

## Этап 4: Game Context - Основы игрового мира (Выполнено)

-   [x] **Определение основных игровых сущностей (данные):**
    -   [x] Товар (`ProductConfig` - уже существует).
    -   [x] Полка/Стеллаж (функционал покрыт `ShelfController` и `ProductConfig`).
    -   [x] Покупатель (`CustomerData.cs`).
    -   [x] Касса (`CashDeskData.cs`).
-   [x] **Сервисы для управления игровыми сущностями:**
    -   [x] `ProductCatalogService`: Доступ к списку всех возможных товаров (из `GameConfigService`).
        -   [x] Интерфейс `IProductCatalogService.cs`.
        -   [x] Класс `ProductCatalogService.cs`.
    -   [x] `InventoryService`: Отслеживание товаров на складе и на полках (базовая реализация существует, но основная логика запасов сейчас через `ShelfController` и `PlayerHandService`).
        -   [x] Интерфейс `IInventoryService.cs`.
        -   [x] Класс `InventoryService.cs`.
    -   [x] Зарегистрированы в `GameContext` (`GameContextInitiator.cs`).
-   [x] **Создание базового игрового окружения:**
    -   [x] Простой пол (Plane) в `GameScene` (создан, увеличен).
    -   [x] **(Требуется ручное действие)** Настроить Main Camera в `GameScene` (например, изометрический вид или вид сверху) или создать, если отсутствует.
-   [x] **Базовый игровой цикл (`GameManager`):**
    -   [x] Создать `GameManager.cs`.
    -   [x] Зарегистрировать в `GameContext`.
    -   [x] Логика старта/окончания игры (пока заглушки).

## Этап 4.5: Персонаж игрока и управление (First-Person) (Выполнено)

-   [x] **Создание персонажа игрока:**
    -   [x] Создать GameObject "Player" в `GameScene`.
    -   [x] Добавить компонент `CharacterController` Unity.
    -   [x] Настроить размеры и положение `CharacterController` (например, центр (0, 1, 0), высота 2, радиус 0.5).
    -   [x] Переместить существующую "SceneCamera" как дочерний объект "Player" для вида от первого лица (настроить ее локальную позицию, например (0, 0.6, 0) относительно игрока).
-   [x] **Реализация управления движением (New Input System):**
    -   [x] Создать Input Actions Asset (например, "PlayerInputActions").
    -   [x] Определить Action Map (например, "PlayerControls") с Actions: "Move" (Vector2), "Look" (Vector2).
    -   [x] Создать скрипт `PlayerController.cs`.
    -   [x] Добавить компонент `PlayerInput` к GameObject "Player" и настроить его на использование созданных Input Actions.
    -   [x] В `PlayerController.cs` обрабатывать сообщения от `PlayerInput` (например, `OnMove`, `OnLook`) или напрямую считывать значения из Actions.
    -   [x] Реализовать логику движения персонажа в `PlayerController.cs` с помощью `CharacterController.Move()`.
    -   [x] Реализовать логику вращения камеры (обзор мышью по горизонтали для всего Player Object, по вертикали только для Camera Object).
    -   [x] Добавить `PlayerController.cs` на GameObject "Player".
-   [x] **Интеграция Raycast для взаимодействия/размещения:**
    -   [x] Убедиться, что Raycast в `GameManager` (для тестового размещения) или будущих системах взаимодействия исходит из камеры игрока (Player's Camera).

## Этап 5: Взаимодействие с игровым миром - Размещение объектов (Частично выполнено)

-   [x] **Система размещения объектов (PlacementSystem):**
    -   [x] Возможность выбирать объект (например, полку) из UI и размещать его на полу в `GameScene`.
    -   [x] Проверка на возможность размещения (базовая, по пересечению с другими объектами через `PlacementServiceConfig.CollisionCheckLayers`).
    -   [x] Вращение объекта перед размещением.
-   [ ] **Улучшения системы размещения:**
    -   [ ] Визуализация сетки для размещения (опционально).
    -   [ ] Более сложная проверка на возможность размещения (не выходит за границы определенной зоны магазина, проверка на тип поверхности).
    -   [ ] Возможность подбирать уже размещенные объекты "в руки" для повторного размещения или возврата на склад/в инвентарь (интеграция с `IInputModeService` для переключения в режим "предмет в руках").
-   [x] **Визуализация размещаемых объектов:**
    -   [x] Создать простые префабы для полок (и других базовых объектов, если есть).
    -   [x] Отображение префаба при размещении (предпросмотр).

## Этап 6: Компьютер Управления Магазином (Выполнено)

-   [x] **Интерфейс компьютера (UI Toolkit):**
    -   [x] Создание UXML/USS для основного экрана компьютера (расположение элементов, стиль).
    -   [x] Секция UI для заказа товаров (список товаров с названием, ценой закупки, полем для ввода количества, итоговой суммой, кнопкой "Заказать").
    -   [x] Секция UI для управления ценами на товары (список товаров с текущей розничной ценой, поле для ввода новой цены, кнопка "Применить").
    -   [x] Секция UI для базовой статистики магазина (дневной доход, количество покупателей).
-   [x] **Функционал заказа товаров:**
    -   [x] Получение списка доступных для закупки товаров (вероятно, из `IProductCatalogService` или специального списка "поставщиков").
    -   [x] Логика выбора товара и указания количества для заказа.
    -   [x] Расчет общей стоимости заказа.
    -   [x] Списание средств с баланса игрока (через `IPlayerDataService.AdjustMoney()`).
    -   [x] Механизм "доставки":
        -   [x] Определение точки/зоны доставки в магазине (например, склад или специальная зона разгрузки).
        -   [x] Создание и размещение объектов "Коробка с товаром" в зоне доставки после успешного заказа.
-   [x] **Функционал управления ценами:**
    -   [x] Отображение списка товаров, для которых можно установить розничную цену.
    -   [x] Получение/хранение текущих розничных цен (возможно, расширить `ProductConfig` или создать отдельный сервис/структуру данных).
    -   [x] Возможность изменять розничные цены через UI компьютера.
    -   [x] Сохранение измененных цен так, чтобы они влияли на покупателей.
-   [x] **Интеграция компьютера в игровой мир:**
    -   [x] Создание интерактивного GameObject "Компьютер" в сцене (например, в офисной зоне магазина).
    -   [x] Система переключения в режим UI компьютера при взаимодействии игрока с объектом "Компьютер" (Raycast + Input Action "Interact").
    -   [x] Блокировка движения игрока и показ курсора мыши при активном UI компьютера (`IInputModeService.SetInputMode(InputMode.UI)`).

## Этап 7: Покупатели (Выполнено)

-   [x] **Появление покупателей (CustomerSpawner):**
    -   [x] Логика спавна покупателей через определенные интервалы или в зависимости от времени/репутации магазина.
    -   [x] Зарегистрировать в `GameContext`.
-   [x] **ИИ Покупателя (базовый):**
    -   [x] Использование NavMesh для навигации.
    -   [x] Движение к полкам с нужными товарами (потребности покупателя).
    -   [x] Выбор товара с полки (взаимодействие с полкой, уменьшение товара на полке).
    -   [x] Движение к кассе.
    -   [x] Ожидание в очереди у кассы.
    -   [x] Уход из магазина после оплаты.
    -   [x] (StateMachine Pattern используется).
-   [x] **Визуализация покупателей:**
    -   [x] Простой префаб для покупателя (например, Capsule или простой гуманоид).

## Этап 8: Управление Товарами, Инвентарем и Распаковка Коробок (Выполнено)

-   [x] **Система коробок с товарами:**
    -   [x] Определение структуры данных для коробок (`BoxData` - какой `ProductConfig` внутри, сколько единиц).
    -   [x] Создание префаба для объекта "Коробка" (визуальное представление, возможно, с информацией о содержимом).
-   [x] **Взаимодействие с коробками (базовое):**
    -   [x] Возможность подобрать коробку "в руки" (через `IPlayerHandService`).
    -   [x] Визуальное отображение информации о коробке в руках игрока (через HUD - название и количество).
    -   [x] Обновление состояния коробки (уменьшение количества товара при использовании, исчезновение пустой).
-   [x] **Механика Открытия/Закрытия Коробки в Руках:**
    -   [x] Добавить состояние "открыта/закрыта" для коробки в `PlayerHandService` (поле `_isBoxOpen`, методы `IsBoxOpen()`, `OpenBox()`, `CloseBox()`, событие `OnBoxStateChanged`).
    -   [x] Реализовать действие для игрока, чтобы открыть/закрыть коробку, которую он держит (`PlayerBoxController` использует `InputAction "ToggleBoxState"`).
    -   [x] Обновить HUD (`HeldBoxInfoLabel` в `GameUIHandler`) для отображения статуса открытой/закрытой коробки и, возможно, подсказки по открытию/закрытию.
-   [x] **Выкладка товаров на полки ИЗ ОТКРЫТОЙ КОРОБКИ В РУКАХ и Возврат Товаров В КОРОБКУ:**
    -   [x] **Условие:** Игрок держит **открытую** коробку и смотрит на полку, которая может принять товар из коробки (или с которой можно забрать товар в коробку).
    -   [x] **Действие ЛКМ (ConfirmPlacement или аналогичное действие):**
        -   [x] Если на полке есть место и в открытой коробке в руках есть товары: один товар перемещается из открытой коробки на полку.
        -   [x] `PlayerHandService` уменьшает количество товара в текущей открытой коробке.
        -   [x] `ShelfController` увеличивает количество товара у себя и обновляет визуализацию (`itemVisuals`).
        -   [x] Это действие не должно приводить к размещению товара "в воздухе" или на не предназначенных для этого поверхностях (т.е. работает только при взгляде на валидную полку).
    -   [x] **Действие ПКМ (CancelPlacement или новое действие "Вернуть в коробку"):**
        -   [x] Если на полке есть товар, который соответствует типу товара в открытой коробке, и в открытой коробке в руках есть место: один товар перемещается с полки обратно в открытую коробку в руках.
        -   [x] `ShelfController` уменьшает количество товара у себя и обновляет визуализацию.
        -   [x] `PlayerHandService` увеличивает количество товара в текущей открытой коробке.
    -   [x] Товары на полке размещаются/забираются из предопределенных точек (`itemVisuals` на `ShelfController` существуют и используются).
    -   [x] Эта механика является специфичным режимом взаимодействия и не использует общий `PlacementService` для крупных объектов (в части выкладки мелких товаров на полку).
-   [x] Отображение товаров на складе (через инвентарь).

## Этап 9: Покупатели (Выполнено - дубликат Этапа 7)

[Этот этап был объединен с этапом 7]

## Этап 10: Кассы и оплата (Выполнено)

-   [x] **Работа кассы:**
    -   [x] Покупатели становятся в очередь к кассе (реализована система очередей).
    -   [x] Процесс "обслуживания" покупателя игроком:
        -   [x] Игрок взаимодействует с кассой (через IInteractable).
        -   [x] "Сканирование" товаров покупателя (получение списка купленных товаров от NPC).
        -   [x] Отображение общей суммы (в консоли).
        -   [x] Прием оплаты (через корутину с задержкой).
    -   [x] Обновление бюджета игрока (`IPlayerDataService.AdjustMoney()`).
-   [x] **Визуализация кассы:**
    -   [x] Простой префаб для кассы (с компонентами).
-   [x] **Дополнительные задачи:**
    -   [x] Настройка префаба кассы в Unity (добавить `CashDeskController`, `Injector`).
    -   [x] UI для отображения процесса обслуживания (в консоли).
    -   [ ] Звуковые эффекты при сканировании и оплате.

## Этап 11: Экономика и UI (Выполнено)

-   [x] **Базовая экономика:**
    -   [x] Отображение бюджета игрока в HUD.
    -   [x] Учет доходов от продаж и расходов на закупку товаров.
-   [x] **Игровой UI (HUD):**
    -   [x] Панель с текущим бюджетом.
    -   [x] Уведомления (например, "Товар закончился на полке X", "Новая доставка прибыла").
-   [x] **Система статистики:**
    -   [x] Сервис статистики (IStatsService/StatsService).
    -   [x] Отслеживание доходов, расходов, количества покупателей.
    -   [x] Подсчет проданных товаров и популярных продуктов.
    -   [x] Интеграция с UI компьютера для отображения статистики.

## Этап 12: Система сохранения/загрузки (Приоритет) (Частично выполнено)

-   [x] **Архитектура системы сохранения:**
    -   [x] Интерфейс `ISaveGameService` с методами Save(), Load(), Delete(), GetSavesList().
    -   [x] Сериализация состояния игры в JSON/бинарный формат.
    -   [x] Версионность сохранений для совместимости.
    -   [x] Система миграции для обновления старых сохранений.
-   [x] **Сохраняемые данные:**
    -   [x] Данные игрока (деньги, прогресс, лицензии).
    -   [x] Состояние магазина (размещенная мебель, товары на полках).
    -   [x] Текущие заказы и доставки.
    -   [x] Статистика и настройки цен.
-   [x] **UI для управления сохранениями:**
    -   [x] Меню сохранения/загрузки в главном меню.
    -   [x] Автосохранение с настраиваемым интервалом.
    -   [x] Уведомления о сохранении.
    -   [x] Быстрое сохранение/загрузка (F5/F9).
    -   [x] Игровое меню (Escape).
    -   [x] Полная интеграция загрузки состояния магазина.

## Этап 13: Улучшение системы полок

-   [x] **Многоуровневые полки:**
    -   [x] Рефакторинг `ShelfController` для поддержки нескольких уровней.
    -   [x] Каждый уровень - отдельный контейнер для товаров.
    -   [x] Визуальное разделение уровней в префабе полки.
-   [x] **Система типов товаров на полках:**
    -   [x] Ограничение: один тип товара на одну полку/уровень.
    -   [x] Автоматическое определение типа по первому положенному товару.
    -   [x] Визуальная индикация занятых типов.
-   [x] **Автоматические ценники:**
    -   [x] Компонент `PriceTagController` для каждого уровня полки.
    -   [x] Автоматическое обновление при изменении товара или цены.
    -   [x] Визуальное отображение названия товара и цены.
    -   [x] Интеграция с системой изменения цен в компьютере.
-   [x] **Дополнительные задачи:**
    -   [x] Обновление `CustomerController` для поддержки многоуровневых полок.
    -   [x] Создание префабов многоуровневых полок в Unity.
    -   [x] Обновление системы сохранения для многоуровневых полок.
    -   [x] Миграция существующих полок на новую систему (опционально).

## Этап 14: Система лицензий на товары (Выполнено)

-   [x] **Архитектура системы лицензий:**
    -   [x] Создание `LicenseSystem` для управления доступными товарами.
    -   [x] Структура данных `ProductLicense` с группами товаров.
    -   [x] Интеграция с `PlayerDataService` для хранения купленных лицензий.
-   [x] **Этапы разблокировки товаров:**
    -   [x] Базовый набор товаров (доступен изначально).
    -   [x] Дополнительные пакеты товаров с разными ценами.
    -   [x] Визуальное отображение заблокированных товаров.
-   [x] **UI для покупки лицензий:**
    -   [x] Новая вкладка "Лицензии" в компьютере.
    -   [x] Карточки доступных лицензий с описанием и ценой.
    -   [x] Индикация уже купленных лицензий.
-   [x] **Интеграция с существующими системами:**
    -   [x] Фильтрация товаров в заказе по купленным лицензиям.
    -   [x] Фильтрация в управлении ценами.
    -   [x] Обновление `IProductCatalogService`.
-   [x] **Дополнительные задачи:**
    -   [x] Создание UI обработчика для вкладки лицензий.
    -   [x] Интеграция с системой сохранения.
    -   [x] Тестирование покупки и разблокировки товаров.
-   [x] **Рефакторинг на ScriptableObjects:**
    -   [x] Переход от хардкода к конфигурации через ScriptableObjects.
    -   [x] Создание `LicenseConfiguration` и `ProductLicense` ассетов.
    -   [x] Исключение мебели из системы лицензий товаров.
    -   [x] Мебель всегда доступна без лицензий (для обустройства магазина).

## Этап 15: Улучшение интерфейса компьютера (Выполнено)

-   [x] **Система категорий товаров:**
    -   [x] Основные категории: Товары, Мебель.
    -   [x] Навигация по категориям с фильтрацией.
    -   [x] Возврат мебели в магазин как отдельная категория.
    -   [x] Мебель доступна без лицензий (для обустройства магазина).
-   [x] **Фильтрация в интерфейсе заказа:**
    -   [x] DropdownField для выбора категории.
    -   [x] Обновление списка товаров при смене категории.
    -   [x] Отображение категории товара в списке.
-   [x] **Редизайн интерфейса магазина:**
    -   [x] Современный дизайн с использованием UI Toolkit.
    -   [x] Улучшенная цветовая схема и типографика.
    -   [x] Карточки товаров вместо списка.
-   [x] **Карточки товаров:**
    -   [x] Отображение спрайта/изображения товара (заглушка с эмодзи).
    -   [x] Название, цена, категория.
    -   [x] Кнопки +/- для изменения количества.
    -   [x] Стильные круглые кнопки с цветовым кодированием.
-   [x] **Корзина покупок:**
    -   [x] Отдельная секция для просмотра выбранных товаров.
    -   [x] Отображение общего количества товаров.
    -   [x] Отображение общей суммы заказа.
    -   [x] Кнопка оформления заказа с динамической активацией.
    -   [x] Визуальная индикация активной/неактивной кнопки.
-   [x] **Переработка структуры интерфейса:**
    -   [x] Товары и Мебель как отдельные вкладки (не фильтр).
    -   [x] Вертикальные подкатегории товаров (Напитки, Снеки, Молочка, Сладости, Орехи).
    -   [x] Отдельные корзины для товаров и мебели.
    -   [x] Умные контролы количества - кнопка "Добавить" появляется только для товаров не в корзине.
    -   [x] Полные контролы (+/-/количество) показываются только для товаров в корзине.
-   [x] **Автоматическая категоризация:**
    -   [x] Система подкатегорий на основе названий товаров.
    -   [x] Фильтрация по подкатегориям в интерфейсе товаров.
-   [x] **Реорганизация структуры вкладок:**
    -   [x] Основная вкладка "Магазин" вместо отдельных вкладок "Товары" и "Мебель".
    -   [x] Подвкладки "Товары" и "Мебель" внутри секции "Магазин".
    -   [x] Сохранение всех остальных вкладок: "Управление Ценами", "Лицензии", "Статистика".
    -   [x] Обновление CSS стилей для подвкладок магазина.
    -   [x] Рефакторинг ComputerUIHandler для поддержки вложенной навигации.
-   [x] **Подкатегории мебели:**
    -   [x] Создание enum FurnitureSubcategory (Вся мебель, Полки, Кассы).
    -   [x] Расширение IProductCatalogService методами для подкатегорий мебели.
    -   [x] Реализация автоматической категоризации мебели по ObjectCategory.
    -   [x] Добавление вертикальной панели подкатегорий в секцию мебели.
    -   [x] Интеграция фильтрации мебели по подкатегориям в UI.
    -   [x] Сохранение отдельных состояний для товаров и мебели.

## Этап 16: Улучшение системы доставки (Выполнено)

-   [x] **Доставка с задержкой:**
    -   [x] Рефакторинг `DeliveryService` для поддержки отложенной доставки.
    -   [x] Настраиваемое время доставки (например, 2-5 минут игрового времени).
    -   [x] Очередь заказов с отслеживанием времени.
-   [x] **Уведомления о доставке:**
    -   [x] Предупреждение за минуту до прибытия.
    -   [x] Уведомление о прибытии доставки.
    -   [x] Визуальная индикация грузовика (опционально).
-   [x] **UI отслеживания заказов:**
    -   [x] Подвкладка "Активные заказы" в секции магазина компьютера.
    -   [x] Список заказов с таймерами (обновляются в реальном времени).
    -   [x] Возможность отменить заказ (с частичным возвратом средств 50%).
-   [x] **Система сохранения активных заказов:**
    -   [x] Интеграция с SaveGameService для сохранения/загрузки активных заказов.
    -   [x] Восстановление таймеров и состояний заказов при загрузке игры.
    -   [x] Обновление счетчика заказов для избежания конфликтов ID.

## Этап 17: Визуальные улучшения взаимодействия с коробками (Выполнено)

-   [x] **Визуализация коробки в руках:**
    -   [x] 3D модель коробки, привязанная к рукам игрока.
    -   [x] Правильное позиционирование и вращение.
-   [x] **Анимации коробки:**
    -   [x] Анимация открытия/закрытия крышки.
    -   [x] Плавное движение при взятии и опускании.
    -   [x] Физика покачивания при ходьбе.
-   [x] **Визуализация содержимого:**
    -   [x] Отображение 3D моделей товаров внутри открытой коробки.
    -   [x] Правильное расположение товаров в сетке.
    -   [x] Исчезновение товаров при выкладке.
-   [x] **Анимация перемещения товаров:**
    -   [x] Визуальный "перелет" товара из коробки на полку.
    -   [x] Обратная анимация при взятии с полки.
    -   [ ] Партиклы или эффекты при перемещении.

## Этап 18: Улучшение системы касс (Выполнено)

-   [x] **Режим работы за кассой:**
    -   [x] Специальная точка активации за кассой.
    -   [x] Переход камеры в фиксированную позицию кассира.
    -   [x] Ограничение движения игрока (только вращение камеры).
    -   [x] Кнопка "Встать с кассы" для выхода из режима.
-   [x] **Визуальная кассовая лента:**
    -   [x] 3D модель кассовой ленты.
    -   [x] Спавн товаров покупателя на ленте.
    -   [ ] Анимация движения ленты (опционально).
-   [x] **Механика сканирования:**
    -   [x] Наведение камеры на товар для подсветки (только вращение камерой, без курсора)
    -   [x] Клик ЛКМ по наведенному товару для сканирования.
    -   [x] Анимация "перелета" товара в зону упаковки.
    -   [ ] Звуковой эффект сканера.
-   [ ] **UI кассы:**
    -   [ ] UI кассы должен быть в мировом пространстве, на модели монитора (UI Toolkit)
    -   [ ] Отображение списка отсканированных товаров.
    -   [ ] Текущая сумма к оплате.
    -   [ ] Кнопка завершения обслуживания.

## Этап 19: Дополнительные улучшения

-   [ ] **Звуковое оформление:**
    -   [ ] Звуки шагов, открытия дверей.
    -   [ ] Звуки взаимодействия с товарами.
    -   [ ] Фоновая музыка в магазине.
    -   [ ] Звуки касс и сканеров.
-   [ ] **Визуальные эффекты:**
    -   [ ] Эффекты при взаимодействии.
    -   [ ] Улучшенное освещение магазина.
    -   [ ] Партиклы при различных действиях.
-   [ ] **Оптимизация производительности:**
    -   [ ] LOD системы для товаров и мебели.
    -   [ ] Оптимизация отрисовки UI.
    -   [ ] Пулинг объектов для покупателей и товаров.

## Этап 20: Дальнейшее развитие (Идеи)

-   [ ] Улучшение ИИ покупателей (разные типы, настроения, реакция на чистоту, очереди).
-   [ ] Персонал (кассиры, грузчики) - найм, управление, зарплаты.
-   [ ] Расширение ассортимента товаров, разные поставщики.
-   [ ] Маркетинг и реклама для привлечения покупателей.
-   [ ] События в игре (например, скидки, проверки СЭС, дни пиковой нагрузки).
-   [ ] Улучшенная графика, модели, анимации.
-   [ ] Расширение магазина, покупка нового оборудования.
-   [ ] Система репутации и отзывов.
-   [ ] Конкуренция с другими магазинами.
-   [ ] Сезонные товары и события.
-   [x] Система внешнего вида персонажей (выполнено как Этап 11 без номера):
    -   [x] Случайная генерация внешности покупателей.
    -   [x] Разные модели для мужчин и женщин.
    -   [x] Случайные цвета одежды для разнообразия.

---
*Этот план будет обновляться по мере выполнения задач.* 